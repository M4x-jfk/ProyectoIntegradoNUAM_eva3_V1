{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NUAM — {% block page_title %}Panel Corporativo{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
    {% block extra_head %}{% endblock %}
</head>
<body class="nuam-body {% block body_class %}{% endblock %}">
    {% block layout %}
    <div class="nuam-layout">
        {% block sidebar %}
        <aside class="nuam-sidebar">
            <div>
                <div class="nuam-logo">NUAM</div>
                <div class="nuam-tagline">Mantenedor Tributario</div>
            </div>
            {% with current=request.resolver_match.url_name|default_if_none:'' %}
            <nav class="nuam-menu">
                <div class="nuam-menu__group">
                    <a class="nuam-menu__item {% if current == 'dashboard' or current == 'login' %}nuam-menu__item--active{% endif %}" href="{% url 'dashboard' %}">Dashboard</a>
                    <a class="nuam-menu__item {% if current == 'usuarios' %}nuam-menu__item--active{% endif %}" href="{% url 'usuarios' %}">Usuarios</a>
                    <a class="nuam-menu__item {% if current == 'calificaciones' %}nuam-menu__item--active{% endif %}" href="{% url 'calificaciones' %}">Calificaciones</a>
                    <a class="nuam-menu__item {% if current == 'partys' %}nuam-menu__item--active{% endif %}" href="{% url 'partys' %}">Partys</a>
                    <a class="nuam-menu__item {% if current == 'carga_masiva' %}nuam-menu__item--active{% endif %}" href="{% url 'carga_masiva' %}">Carga Masiva</a>
                    <a class="nuam-menu__item {% if current == 'auditoria' %}nuam-menu__item--active{% endif %}" href="{% url 'auditoria' %}">Auditoría</a>
                </div>
            </nav>
            {% endwith %}
            <div class="nuam-footer">
                NUAM © {{ now|date:"Y" }}<br>
                soporte@nuam.cl
            </div>
        </aside>
        {% endblock %}
        <div class="nuam-main">
            <header class="nuam-topbar">
                <div>
                    <h1 class="nuam-page-title">{% block header_title %}Panel Corporativo{% endblock %}</h1>
                    <p class="nuam-tagline">{% block header_subtitle %}NUAM — Mantenedor de Calificaciones Tributarias{% endblock %}</p>
                </div>
                <div class="nuam-search">
                    <input type="search" placeholder="Buscar en NUAM">
                </div>
                <div>
                    <span class="nuam-tagline">Sesión: {{ request.session.nuam_nombre|default:"Invitado" }}</span>
                </div>
                <div class="nuam-avatar">{{ request.session.nuam_nombre|default:"NU" | slice:":2" }}</div>
                <form method="post" action="{% url 'logout' %}">
                    {% csrf_token %}
                    <button class="nuam-btn nuam-btn--ghost" type="submit">Cerrar sesión</button>
                </form>
            </header>
            <main class="nuam-content">
                {% block content %}{% endblock %}
            </main>
            <footer class="nuam-footer">
                Desarrollado por NUAM · Mantenedor de Calificaciones Tributarias — Información confidencial.
            </footer>
        </div>
    </div>
    {% endblock %}
    {% block extra_scripts %}{% endblock %}
</body>
</html>
