{% extends 'templatesApp/base.html' %}
{% block title %}Calificaciones{% endblock %}
{% block content %}
<h1>Calificaciones (HU01-HU06)</h1>
<div>
    {% if can_manage_calif %}
        <a href="{% url 'calificaciones_create' %}">Nueva calificacion</a>
        <a href="{% url 'calificaciones_export' %}">Exportar (placeholder)</a>
    {% endif %}
    <form method="get" style="display:inline-block;margin-left:12px;">
        <select name="estado_registro" onchange="this.form.submit()">
            <option value="">Todos los estados</option>
            <option value="vigente">Vigente</option>
            <option value="reemplazado">Reemplazado</option>
            <option value="anulado">Anulado</option>
        </select>
    </form>
    <input type="search" name="q" placeholder="Buscar emisor..." style="margin-left:8px;">
</div>
<table>
    <thead>
        <tr>
            <th>Emisor</th><th>Instrumento</th><th>Anio</th><th>Monto</th><th>Factor</th><th>Estado</th><th></th>
        </tr>
    </thead>
    <tbody>
        {% for c in calificaciones %}
        <tr>
            <td>{{ c.emisor }}</td>
            <td>{{ c.instrumento }}</td>
            <td>{{ c.anio }}</td>
            <td>{{ c.monto }}</td>
            <td>{{ c.factor }}</td>
            <td>{{ c.get_estado_registro_display }}</td>
            <td>
                <a href="{% url 'calificaciones_detail' c.pk %}">Ver</a>
                {% if can_manage_calif %}
                    | <a href="{% url 'calificaciones_update' c.pk %}">Editar</a>
                    | <a href="{% url 'calificaciones_delete' c.pk %}">Eliminar</a>
                {% endif %}
            </td>
        </tr>
        {% empty %}
        <tr>
            <td>Emisor Demo SpA</td>
            <td>Instrumento Demo</td>
            <td>2025</td>
            <td>2500000</td>
            <td>0.0520</td>
            <td>Vigente</td>
            <td><em>Ejemplo demostrativo</em></td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
